import i18n from 'i18next';
import { initReactI18next } from 'react-i18next';

const STORAGE_KEY = 'lit_rag_lang';

const resources = {
  en: {
    translation: {
      nav: {
        home: 'Home',
        dataset: 'Dataset',
        chat: 'Chat',
        search: 'Search',
        agent: 'Agent',
        files: 'Files',
        jobs: 'Knowledge Bases',
      },
      common: {
        language: 'Language',
        english: 'English',
        german: 'Deutsch',
        all: 'All',
        sign_in: 'Sign in',
        sign_out: 'Log out',
        cancel: 'Cancel',
        create: 'Create',
        delete: 'Delete',
        done: 'Done',
        search: 'Search',
        upload: 'Upload',
        pages: 'pages',
        unknown_error: 'Unknown error',
        profile: 'Profile',
        team: 'Team',
        mcp: 'MCP',
        data_sources: 'Data sources',
        model_providers: 'Model providers',
        knowledge_bases: 'Knowledge Bases',
      },
      kb: {
        select: 'Select Knowledge Base',
        docs: 'docs',
        chunks: 'chunks',
        create_new: 'Create New Knowledge Base',
        sign_in_to_create: 'Sign in to create your own knowledge base',
      },
      jobs: {
        title: 'Knowledge Bases',
        new_kb: 'New Knowledge Base',
        create_kb: 'Create Knowledge Base',
        create_title: 'Create New Knowledge Base',
        name_label: 'Name *',
        name_placeholder: 'My Research Project',
        description_label: 'Description',
        description_placeholder: 'Brief description of this knowledge base...',
        creating: 'Creating...',
        create_failed: 'Failed to create knowledge base',
        deleting: 'Deleting...',
        delete_title: 'Delete Knowledge Base',
        delete_confirm: 'Are you sure you want to delete \"{{name}}\"? This will permanently delete all {{documents}} documents and {{chunks}} indexed chunks. This action cannot be undone.',
        search_placeholder: 'Search knowledge bases...',
        load_failed: 'Failed to load knowledge bases',
        empty_title: 'No knowledge bases yet',
        empty_subtitle: 'Create your first knowledge base to start uploading documents.',
        empty_action: 'Create Knowledge Base',
        no_results_title: 'No matching knowledge bases',
        no_results_subtitle: 'Try a different search term.',
        created: 'Created {{date}}',
      },
      files: {
        title: 'Files',
        upload_to: 'Upload to {{name}}',
        upload_first: 'Upload your first PDF',
        upload_cta: 'Upload',
        upload_dialog_title: 'Upload PDF to {{name}}',
        select_file: 'Select a PDF file',
        drop_pdf: 'Please drop a PDF file',
        load_failed: 'Failed to load documents',
        select_topic_error: 'Please select or enter a topic',
        drop_here: 'Drop PDF here',
        to_upload_to: 'to upload to {{name}}',
        search_documents: 'Search documents...',
        table_name: 'Name',
        table_phase: 'Phase',
        table_topic: 'Topic',
        table_year: 'Year',
        table_size: 'Size',
        table_action: 'Action',
        loading_documents: 'Loading documents...',
        no_documents: 'No documents yet',
        no_match: 'No documents match your search',
        total: 'Total {{count}}',
        per_page: '{{count}} / Page',
        upload_description: 'Select phase and topic for the document to be indexed properly.',
        select_phase: 'Select a phase',
        select_topic_placeholder: 'Select existing topic or enter new',
        enter_new_topic_label: 'or enter a new topic:',
        enter_new_topic_placeholder: 'Enter new topic name...',
        delete_title: 'Delete document',
        delete_confirm: 'Are you sure you want to delete \"{{name}}\"?',
        phase_label: 'Phase',
        topic_label: 'Topic',
        custom_topic: 'Custom topic',
        processing: 'Processing...',
        uploading: 'Uploading...',
        upload_index: 'Upload & Index',
        upload_progress: 'Processing started...',
        upload_failed: 'Upload failed',
        upload_success: 'Successfully uploaded {{name}}',
        file_size: 'Max file size: {{size}} MB',
        allowed_extensions: 'Allowed: {{extensions}}',
        no_files: 'No files uploaded yet',
        search_placeholder: 'Search files...',
      },
      job_detail: {
        title: 'Knowledge Base',
        not_found: 'Knowledge base not found',
        back_to_jobs: 'Back to Knowledge Bases',
        documents_label: 'Documents',
        chunks_label: 'Chunks',
        topics_label: 'Topics',
        search_documents: 'Search documents...',
        no_documents: 'No documents yet',
        upload_pdf: 'Upload PDF',
        upload_pdfs: 'Upload PDFs',
        upload_first_pdf: 'Upload your first PDF to get started.',
        phase_label: 'Phase',
        topic_label: 'Topic',
        topic_placeholder: 'e.g., Business Formation',
        select_files: 'Select PDF files',
        add_more_files: 'Add more files',
        files_count: 'Files ({{count}})',
        uploading_progress: 'Uploading... {{completed}}/{{total}} complete',
        failed_count: ', {{failed}} failed',
        done: 'Done',
        cancel: 'Cancel',
        upload_button: 'Upload {{count}} file',
        upload_button_plural: 'Upload {{count}} files',
        delete_doc_title: 'Delete document',
        delete_doc_confirm: 'Are you sure you want to delete \"{{name}}\"?',
        clear_title: 'Clear knowledge base',
        clear_confirm: 'This will delete {{documents}} documents and {{chunks}} chunks.',
        query_title: 'Query Knowledge Base',
        query_placeholder: 'Ask a question about your documents...',
        query_button: 'Ask',
        table_document: 'Document',
        table_phase_topic: 'Phase / Topic',
        table_chunks: 'Chunks',
        table_added: 'Added',
        table_actions: 'Actions',
      },
      home: {
        hero_title: 'Your Literature Review, Supercharged',
        hero_subtitle: 'Upload papers, build knowledge bases, and ask questions with citations.',
        cta_primary: 'Get Started',
        cta_secondary: 'Explore Demo',
        create_first_kb: 'Create your first knowledge base to start uploading and querying your own documents.',
        sign_in_upload: 'Sign in to upload your own documents and build custom RAG applications.',
        welcome: 'Welcome to',
        hello: 'Hello, {{name}}! Manage your knowledge bases.',
        guest_subtitle: 'Intelligent Knowledge Retrieval Platform',
        your_kbs: 'Your Knowledge Bases',
        new: 'New',
        no_kb_yet: 'No knowledge bases yet',
        create_kb: 'Create Knowledge Base',
        stats_kbs: 'Knowledge Bases',
        stats_docs: 'Total Documents',
        stats_chunks: 'Total Chunks',
        more: '+{{count}} more',
        view_all: 'View all',
        demo_title: 'Public Demo Collection',
        demo_subtitle: '{{count}} papers on German regional economic transitions',
        demo_chat: 'Chat with Demo',
        demo_browse: 'Browse Papers',
        guest_total_papers: 'Total Papers',
        guest_total_chunks: 'Total Chunks',
        guest_phases: 'Phases',
        guest_year_range: 'Year Range',
        stats_error: 'Failed to load stats',
      },
      chat: {
        title: 'Chat',
        querying: 'Querying: {{name}}',
        history_saved: 'History saved only in opened sessions',
        open_session: 'Open Session',
        new_session: 'New Session',
        clear_session: 'Clear Session',
        no_saved_sessions: 'No saved sessions',
        export: 'Export',
        deep_analysis: 'Deep Analysis',
        phase: 'Phase',
        topic: 'Topic',
        start_conversation: 'Start a conversation',
        ask_default: 'Ask questions about the academic literature in the demo collection',
        ask_kb: 'Ask questions about documents in "{{name}}"',
        documents: '{{documents}} documents · {{chunks}} chunks',
        references: 'References',
        details: 'Details',
        ask_question: 'Ask a question about {{name}}...',
        the_literature: 'the literature',
        session_label: 'Session {{label}}',
      },
      search: {
        title: 'Search',
        searching: 'Searching: {{name}}',
        search_placeholder: 'Search {{name}}...',
        phase: 'Phase',
        topic: 'Topic',
        all_phases: 'All Phases',
        all_topics: 'All Topics',
        button: 'Search',
        results: 'Results ({{count}})',
        score: 'Score: {{score}}%',
        search_failed: 'Search failed: {{error}}',
        no_results: 'No results found',
        empty_prompt: 'Enter a query to search {{name}}',
      },
      auth: {
        sign_in_title: 'Sign in to your account',
        create_account_title: 'Create a new account',
        continue_google: 'Continue with Google',
        continue_github: 'Continue with GitHub',
        or_continue_email: 'Or continue with email',
        name_optional: 'Name (optional)',
        email_address: 'Email address',
        password: 'Password',
        confirm_password: 'Confirm Password',
        sign_in: 'Sign in',
        create_account: 'Create account',
        dont_have_account: "Don't have an account? Sign up",
        already_have_account: 'Already have an account? Sign in',
        back_home: 'Back to home',
        password_mismatch: 'Passwords do not match',
        password_length: 'Password must be at least 8 characters',
        auth_failed: 'Authentication failed',
        oauth_failed: 'Failed to initiate OAuth',
      },
    },
  },
  de: {
    translation: {
      nav: {
        home: 'Startseite',
        dataset: 'Datensatz',
        chat: 'Chat',
        search: 'Suche',
        agent: 'Agent',
        files: 'Dateien',
        jobs: 'Wissensbasen',
      },
      common: {
        language: 'Sprache',
        english: 'Englisch',
        german: 'Deutsch',
        all: 'Alle',
        sign_in: 'Anmelden',
        sign_out: 'Abmelden',
        cancel: 'Abbrechen',
        create: 'Erstellen',
        delete: 'Löschen',
        done: 'Fertig',
        search: 'Suchen',
        upload: 'Hochladen',
        pages: 'Seiten',
        unknown_error: 'Unbekannter Fehler',
        profile: 'Profil',
        team: 'Team',
        mcp: 'MCP',
        data_sources: 'Datenquellen',
        model_providers: 'Modellanbieter',
        knowledge_bases: 'Wissensbasen',
      },
      kb: {
        select: 'Wissensbasis auswählen',
        docs: 'Dokumente',
        chunks: 'Chunks',
        create_new: 'Neue Wissensbasis erstellen',
        sign_in_to_create: 'Anmelden, um eine eigene Wissensbasis zu erstellen',
      },
      jobs: {
        title: 'Wissensbasen',
        new_kb: 'Neue Wissensbasis',
        create_kb: 'Wissensbasis erstellen',
        create_title: 'Neue Wissensbasis erstellen',
        name_label: 'Name *',
        name_placeholder: 'Mein Forschungsprojekt',
        description_label: 'Beschreibung',
        description_placeholder: 'Kurze Beschreibung dieser Wissensbasis...',
        creating: 'Wird erstellt...',
        create_failed: 'Wissensbasis konnte nicht erstellt werden',
        deleting: 'Wird gelöscht...',
        delete_title: 'Wissensbasis löschen',
        delete_confirm: 'Möchten Sie „{{name}}“ wirklich löschen? Dabei werden dauerhaft alle {{documents}} Dokumente und {{chunks}} indexierten Chunks gelöscht. Diese Aktion kann nicht rückgängig gemacht werden.',
        search_placeholder: 'Wissensbasen suchen...',
        load_failed: 'Wissensbasen konnten nicht geladen werden',
        empty_title: 'Noch keine Wissensbasen',
        empty_subtitle: 'Erstellen Sie Ihre erste Wissensbasis, um Dokumente hochzuladen.',
        empty_action: 'Wissensbasis erstellen',
        no_results_title: 'Keine passenden Wissensbasen',
        no_results_subtitle: 'Versuchen Sie einen anderen Suchbegriff.',
        created: 'Erstellt {{date}}',
      },
      files: {
        title: 'Dateien',
        upload_to: 'Hochladen in {{name}}',
        upload_first: 'Erstes PDF hochladen',
        upload_cta: 'Hochladen',
        upload_dialog_title: 'PDF hochladen zu {{name}}',
        select_file: 'PDF-Datei auswählen',
        drop_pdf: 'Bitte eine PDF-Datei ablegen',
        load_failed: 'Dokumente konnten nicht geladen werden',
        select_topic_error: 'Bitte ein Thema auswählen oder eingeben',
        drop_here: 'PDF hier ablegen',
        to_upload_to: 'um in {{name}} hochzuladen',
        search_documents: 'Dokumente suchen...',
        table_name: 'Name',
        table_phase: 'Phase',
        table_topic: 'Thema',
        table_year: 'Jahr',
        table_size: 'Größe',
        table_action: 'Aktion',
        loading_documents: 'Dokumente werden geladen...',
        no_documents: 'Noch keine Dokumente',
        no_match: 'Keine Dokumente entsprechen Ihrer Suche',
        total: 'Gesamt {{count}}',
        per_page: '{{count}} / Seite',
        upload_description: 'Wählen Sie Phase und Thema, damit das Dokument korrekt indexiert wird.',
        select_phase: 'Phase auswählen',
        select_topic_placeholder: 'Vorhandenes Thema auswählen oder neues eingeben',
        enter_new_topic_label: 'oder neues Thema eingeben:',
        enter_new_topic_placeholder: 'Neues Thema eingeben...',
        delete_title: 'Dokument löschen',
        delete_confirm: 'Möchten Sie „{{name}}“ wirklich löschen?',
        phase_label: 'Phase',
        topic_label: 'Thema',
        custom_topic: 'Benutzerdefiniertes Thema',
        processing: 'Wird verarbeitet...',
        uploading: 'Wird hochgeladen...',
        upload_index: 'Hochladen & Indexieren',
        upload_progress: 'Verarbeitung gestartet...',
        upload_failed: 'Upload fehlgeschlagen',
        upload_success: '{{name}} erfolgreich hochgeladen',
        file_size: 'Max. Dateigröße: {{size}} MB',
        allowed_extensions: 'Erlaubt: {{extensions}}',
        no_files: 'Noch keine Dateien hochgeladen',
        search_placeholder: 'Dateien suchen...',
      },
      job_detail: {
        title: 'Wissensbasis',
        not_found: 'Wissensbasis nicht gefunden',
        back_to_jobs: 'Zurück zu Wissensbasen',
        documents_label: 'Dokumente',
        chunks_label: 'Chunks',
        topics_label: 'Themen',
        search_documents: 'Dokumente suchen...',
        no_documents: 'Noch keine Dokumente',
        upload_pdf: 'PDF hochladen',
        upload_pdfs: 'PDFs hochladen',
        upload_first_pdf: 'Laden Sie Ihr erstes PDF hoch, um zu starten.',
        phase_label: 'Phase',
        topic_label: 'Thema',
        topic_placeholder: 'z. B. Unternehmensgründung',
        select_files: 'PDF-Dateien auswählen',
        add_more_files: 'Weitere Dateien hinzufügen',
        files_count: 'Dateien ({{count}})',
        uploading_progress: 'Wird hochgeladen... {{completed}}/{{total}} abgeschlossen',
        failed_count: ', {{failed}} fehlgeschlagen',
        done: 'Fertig',
        cancel: 'Abbrechen',
        upload_button: '{{count}} Datei hochladen',
        upload_button_plural: '{{count}} Dateien hochladen',
        delete_doc_title: 'Dokument löschen',
        delete_doc_confirm: 'Möchten Sie „{{name}}“ wirklich löschen?',
        clear_title: 'Wissensbasis leeren',
        clear_confirm: 'Dies löscht {{documents}} Dokumente und {{chunks}} Chunks.',
        query_title: 'Wissensbasis abfragen',
        query_placeholder: 'Stelle eine Frage zu deinen Dokumenten...',
        query_button: 'Fragen',
        table_document: 'Dokument',
        table_phase_topic: 'Phase / Thema',
        table_chunks: 'Chunks',
        table_added: 'Hinzugefügt',
        table_actions: 'Aktionen',
      },
      home: {
        hero_title: 'Deine Literaturrecherche, beschleunigt',
        hero_subtitle: 'Lade Papers hoch, baue Wissensbasen und stelle Fragen mit Zitaten.',
        cta_primary: 'Loslegen',
        cta_secondary: 'Demo ansehen',
        create_first_kb: 'Erstellen Sie Ihre erste Wissensbasis, um eigene Dokumente hochzuladen und zu durchsuchen.',
        sign_in_upload: 'Melden Sie sich an, um eigene Dokumente hochzuladen und benutzerdefinierte RAG-Anwendungen zu erstellen.',
        welcome: 'Willkommen bei',
        hello: 'Hallo, {{name}}! Verwalte deine Wissensbasen.',
        guest_subtitle: 'Intelligente Plattform für Wissenssuche',
        your_kbs: 'Deine Wissensbasen',
        new: 'Neu',
        no_kb_yet: 'Noch keine Wissensbasen',
        create_kb: 'Wissensbasis erstellen',
        stats_kbs: 'Wissensbasen',
        stats_docs: 'Dokumente gesamt',
        stats_chunks: 'Chunks gesamt',
        more: '+{{count}} mehr',
        view_all: 'Alle anzeigen',
        demo_title: 'Öffentliche Demo-Sammlung',
        demo_subtitle: '{{count}} Papers zu regionalen ökonomischen Übergängen in Deutschland',
        demo_chat: 'Mit Demo chatten',
        demo_browse: 'Papers ansehen',
        guest_total_papers: 'Papers gesamt',
        guest_total_chunks: 'Chunks gesamt',
        guest_phases: 'Phasen',
        guest_year_range: 'Jahresbereich',
        stats_error: 'Statistiken konnten nicht geladen werden',
      },
      chat: {
        title: 'Chat',
        querying: 'Abfrage: {{name}}',
        history_saved: 'Verlauf wird nur in geöffneten Sitzungen gespeichert',
        open_session: 'Sitzung öffnen',
        new_session: 'Neue Sitzung',
        clear_session: 'Sitzung leeren',
        no_saved_sessions: 'Keine gespeicherten Sitzungen',
        export: 'Exportieren',
        deep_analysis: 'Tiefenanalyse',
        phase: 'Phase',
        topic: 'Thema',
        start_conversation: 'Starte eine Unterhaltung',
        ask_default: 'Stelle Fragen zur akademischen Literatur der Demo-Sammlung',
        ask_kb: 'Stelle Fragen zu Dokumenten in "{{name}}"',
        documents: '{{documents}} Dokumente · {{chunks}} Chunks',
        references: 'Quellen',
        details: 'Details',
        ask_question: 'Stelle eine Frage zu {{name}}...',
        the_literature: 'der Literatur',
        session_label: 'Sitzung {{label}}',
      },
      search: {
        title: 'Suche',
        searching: 'Suche: {{name}}',
        search_placeholder: 'Suche {{name}}...',
        phase: 'Phase',
        topic: 'Thema',
        all_phases: 'Alle Phasen',
        all_topics: 'Alle Themen',
        button: 'Suchen',
        results: 'Ergebnisse ({{count}})',
        score: 'Score: {{score}}%',
        search_failed: 'Suche fehlgeschlagen: {{error}}',
        no_results: 'Keine Ergebnisse gefunden',
        empty_prompt: 'Gib eine Suchanfrage ein für {{name}}',
      },
      auth: {
        sign_in_title: 'Melde dich bei deinem Konto an',
        create_account_title: 'Neues Konto erstellen',
        continue_google: 'Mit Google fortfahren',
        continue_github: 'Mit GitHub fortfahren',
        or_continue_email: 'Oder mit E-Mail fortfahren',
        name_optional: 'Name (optional)',
        email_address: 'E-Mail-Adresse',
        password: 'Passwort',
        confirm_password: 'Passwort bestätigen',
        sign_in: 'Anmelden',
        create_account: 'Konto erstellen',
        dont_have_account: 'Noch kein Konto? Registrieren',
        already_have_account: 'Schon ein Konto? Anmelden',
        back_home: 'Zurück zur Startseite',
        password_mismatch: 'Passwörter stimmen nicht überein',
        password_length: 'Passwort muss mindestens 8 Zeichen haben',
        auth_failed: 'Authentifizierung fehlgeschlagen',
        oauth_failed: 'OAuth konnte nicht gestartet werden',
      },
    },
  },
};

const savedLanguage = localStorage.getItem(STORAGE_KEY);
const browserLanguage = navigator.language?.toLowerCase().startsWith('de') ? 'de' : 'en';
const initialLanguage = savedLanguage || browserLanguage;

i18n
  .use(initReactI18next)
  .init({
    resources,
    lng: initialLanguage,
    fallbackLng: 'en',
    interpolation: { escapeValue: false },
  });

export function setLanguage(language: 'en' | 'de') {
  i18n.changeLanguage(language);
  localStorage.setItem(STORAGE_KEY, language);
}

export default i18n;
